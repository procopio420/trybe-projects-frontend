{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/procopio/Projetos/trybe-github/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _slicedToArray from\"/home/procopio/Projetos/trybe-github/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useRouteMatch,Link}from'react-router-dom';import{FiArrowRight,FiChevronLeft,FiChevronRight,FiUsers}from'react-icons/fi';import ReactLoading from'react-loading';import Modal from'react-bootstrap/Modal';import api,{my_api}from'../../services/api';import logoImg from'../../assets/trybe.png';import{Header,RepositoryInfo,Issues,TableContainer}from'./styles';var Repository=function Repository(){var _useRouteMatch=useRouteMatch(),params=_useRouteMatch.params;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),repository=_useState2[0],setRepository=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),pullRequests=_useState4[0],setPullRequests=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),pullRequestsWithCr=_useState6[0],setPullRequestsWithCr=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),helpNumber=_useState8[0],setHelpNumber=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),crNumber=_useState10[0],setCrNumber=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),duplas=_useState12[0],setDuplas=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),dataToShow=_useState14[0],setDataToShow=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),showModal=_useState16[0],setShowModal=_useState16[1];useEffect(function(){api.get(\"repos/\".concat(params.repository)).then(function(response){setRepository(response.data);console.log('--------------------------------');console.log('HORA (ms): ',new Date().getMilliseconds());console.log('COMANDO: SETAR REPOSITORIO');console.log('--------------------------------');});api.get(\"repos/\".concat(params.repository,\"/pulls?per_page=100\")).then(function(response){setPullRequests(response.data);console.log('--------------------------------');console.log('HORA (ms): ',new Date().getMilliseconds());console.log('COMANDO: SETAR PULL REQUESTS');console.log('--------------------------------');});},[params.repository]);useEffect(function(){if(repository){console.log('--------------------------------');console.log('HORA (ms): ',new Date().getMilliseconds());console.log('EFEITO: REPOSITORIO SETADO');console.log(repository);console.log('--------------------------------');}},[repository]);useEffect(function(){if(pullRequests.length>0){console.log('--------------------------------');console.log('HORA (ms): ',new Date().getMilliseconds());console.log('EFEITO: PULLREQUESTS SETADO');console.log(pullRequests);console.log('--------------------------------');}},[pullRequests]);useEffect(function(){if(pullRequestsWithCr.length>0){console.log('--------------------------------');console.log('HORA (ms): ',new Date().getMilliseconds());console.log('EFEITO: PULLREQUESTS COM CR SETADO');console.log(pullRequestsWithCr);console.log('--------------------------------');postTheDataDuplas();}},[pullRequestsWithCr]);useEffect(function(){if(pullRequests.length>0){console.log('--------------------------------');console.log('HORA (ms): ',new Date().getMilliseconds());console.log('COMANDO: SETAR PULLREQUESTS COM CR');console.log('--------------------------------');var helps=0;var crs=0;var prWithCr=[];var _iterator=_createForOfIteratorHelper(pullRequests),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var pull=_step.value;pull.helpWanted=false;pull.codeReview=false;pull.jaTemDupla=false;if(pull.labels.length>0){for(var i=0;i<pull.labels.length;i++){if(pull.labels[i].name==='help wanted'){helps++;pull.helpWanted=true;}if(pull.labels[i].name==='code-review'){crs++;pull.codeReview=true;prWithCr.push(pull.user.login);}}}}}catch(err){_iterator.e(err);}finally{_iterator.f();}setPullRequestsWithCr(prWithCr);setDataToShow(pullRequests);setCrNumber(crs);setHelpNumber(helps);}},[pullRequests]);function postTheDataDuplas(){console.log('----------------------------------');console.log('STARTED POST','AT: ',new Date().getMilliseconds());my_api.post(\"/\".concat(repository===null||repository===void 0?void 0:repository.id),pullRequestsWithCr);console.log('POST FINISHED','AT: ',new Date().getMilliseconds(),pullRequestsWithCr);console.log('----------------------------------');setTimeout(function(){if(repository){getAndSetDuplasState();}},1000);}function getAndSetDuplasState(){console.log('----------------------------------');console.log('STARTED GET','AT: ',new Date().getMilliseconds());my_api.get(\"/\".concat(repository===null||repository===void 0?void 0:repository.id)).then(function(response){setDuplas(response.data);console.log('GET FINISHED','AT: ',new Date().getMilliseconds(),response.data);console.log('----------------------------------');});}useEffect(function(){if(duplas.length>0){console.log('----------------------------------');console.log('DUPLAS UPDATED','AT: ',new Date().getMilliseconds());console.log(duplas);console.log('----------------------------------');}},[duplas]);function handleDuplasButton(){handleOpenModal();}var handleOpenModal=function handleOpenModal(){return setShowModal(true);};var handleCloseModal=function handleCloseModal(){return setShowModal(false);};function handleHelpButton(){var newPullRequests=pullRequests.filter(function(pull){return pull.helpWanted;});setDataToShow(newPullRequests);}function handleCRButton(){var newPullRequests=pullRequests.filter(function(pull){return pull.codeReview;});setDataToShow(newPullRequests);}function handlePRButton(){setDataToShow(pullRequests);}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Header,null,/*#__PURE__*/React.createElement(\"img\",{src:logoImg,width:150,alt:\"Trybe - Projects Explorer\"}),/*#__PURE__*/React.createElement(Link,{to:\"/trybe-projects\"},/*#__PURE__*/React.createElement(FiChevronLeft,{size:16}),\"Voltar\")),repository&&/*#__PURE__*/React.createElement(RepositoryInfo,null,/*#__PURE__*/React.createElement(\"header\",null,/*#__PURE__*/React.createElement(\"img\",{src:repository.owner.avatar_url,alt:repository.owner.login}),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"strong\",null,repository.name)),/*#__PURE__*/React.createElement(\"button\",{onClick:handleDuplasButton},/*#__PURE__*/React.createElement(FiUsers,{size:24}),\"Ver duplas de CR\")),/*#__PURE__*/React.createElement(\"ul\",null,/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:handleHelpButton},/*#__PURE__*/React.createElement(\"strong\",null,helpNumber),/*#__PURE__*/React.createElement(\"span\",null,\"Pedido(s) de ajuda\"))),/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:handleCRButton},/*#__PURE__*/React.createElement(\"strong\",null,crNumber),/*#__PURE__*/React.createElement(\"span\",null,\"Pedido(s) de Code Review\"))),/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(Link,{to:\"#\",onClick:handlePRButton},/*#__PURE__*/React.createElement(\"strong\",null,repository.open_issues_count),/*#__PURE__*/React.createElement(\"span\",null,\"Pull Requests\"))))),/*#__PURE__*/React.createElement(Modal,{show:showModal,onHide:handleCloseModal,size:'lg'},/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(TableContainer,null,/*#__PURE__*/React.createElement(\"h1\",null,\"Duplas de Code Review\"),duplas.length>0?duplas.map(function(dupla,index){return/*#__PURE__*/React.createElement(\"section\",{key:dupla.dupla1},/*#__PURE__*/React.createElement(\"p\",null,dupla.dupla1),/*#__PURE__*/React.createElement(FiArrowRight,{size:20}),/*#__PURE__*/React.createElement(\"p\",null,dupla.dupla2));}):/*#__PURE__*/React.createElement(\"article\",null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(ReactLoading,{type:'spin',color:'#0fa36b',height:'50%',width:'50%'}),/*#__PURE__*/React.createElement(\"h2\",null,\"Carregando\")))))),/*#__PURE__*/React.createElement(Issues,null,dataToShow.filter(function(pull){return pull.user.login!=='tryber';}).sort(function(a,b){if(a.codeReview&&!b.codeReview){return-1;}if(a.helpWanted&&!b.helpWanted){return-1;}return 1;}).map(function(pull){return/*#__PURE__*/React.createElement(\"a\",{key:pull.id,href:pull.html_url},/*#__PURE__*/React.createElement(\"img\",{src:pull.user.avatar_url,alt:pull.user.login}),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"strong\",null,pull.user.login),/*#__PURE__*/React.createElement(\"p\",null,pull.title)),pull.helpWanted&&/*#__PURE__*/React.createElement(\"span\",{className:\"red\"},\"Ajuda\"),pull.codeReview&&/*#__PURE__*/React.createElement(\"span\",{className:\"green\"},\"Code Review\"),/*#__PURE__*/React.createElement(FiChevronRight,{size:20}));})));};export default Repository;","map":{"version":3,"sources":["/home/procopio/Projetos/trybe-github/frontend/src/pages/Repository/index.tsx"],"names":["React","useEffect","useState","useRouteMatch","Link","FiArrowRight","FiChevronLeft","FiChevronRight","FiUsers","ReactLoading","Modal","api","my_api","logoImg","Header","RepositoryInfo","Issues","TableContainer","Repository","params","repository","setRepository","pullRequests","setPullRequests","pullRequestsWithCr","setPullRequestsWithCr","helpNumber","setHelpNumber","crNumber","setCrNumber","duplas","setDuplas","dataToShow","setDataToShow","showModal","setShowModal","get","then","response","data","console","log","Date","getMilliseconds","length","postTheDataDuplas","helps","crs","prWithCr","pull","helpWanted","codeReview","jaTemDupla","labels","i","name","push","user","login","post","id","setTimeout","getAndSetDuplasState","handleDuplasButton","handleOpenModal","handleCloseModal","handleHelpButton","newPullRequests","filter","handleCRButton","handlePRButton","owner","avatar_url","open_issues_count","map","dupla","index","dupla1","dupla2","sort","a","b","html_url","title"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useRouteMatch, Link } from 'react-router-dom';\nimport { FiArrowRight, FiChevronLeft , FiChevronRight, FiUsers } from 'react-icons/fi';\nimport ReactLoading from 'react-loading';\nimport Modal from 'react-bootstrap/Modal';\n\nimport api, { my_api } from '../../services/api';\n\nimport logoImg from '../../assets/trybe.png';\n\nimport { Header, RepositoryInfo, Issues, TableContainer } from './styles';\n\ninterface RepositoryParams {\n  repository: string;\n}\n\ninterface Repository {\n  id: number;\n  full_name: string;\n  name: string;\n  description: string;\n  stargazers_count: number;\n  forks_count: number;\n  open_issues_count: number;\n  owner: {\n    login: string;\n    avatar_url: string;\n  };\n}\n\ninterface PullRequest {\n  title: string;\n  id: number;\n  html_url: string;\n  mergeable_state: string | undefined;\n  user: {\n    login: string;\n    url: string;\n    avatar_url: string;\n  };\n  number: number;\n  labels: [\n    {\n      name: string;\n    },\n  ];\n  codeReview: boolean;\n  helpWanted: boolean;\n  jaTemDupla: boolean;\n}\n\ninterface Dupla {\n  dupla1: string;\n  dupla2: string;\n}\n\nconst Repository: React.FC = () => {\n  const { params } = useRouteMatch<RepositoryParams>();\n\n  const [repository, setRepository] = useState<Repository | null>(null);\n  const [pullRequests, setPullRequests] = useState<PullRequest[]>([]);\n  const [pullRequestsWithCr, setPullRequestsWithCr] = useState<String[]>([]);\n  const [helpNumber, setHelpNumber] = useState(0);\n  const [crNumber, setCrNumber] = useState(0);\n\n  const [duplas, setDuplas] = useState<Dupla[]>([]);\n\n  const [dataToShow, setDataToShow] = useState<PullRequest[]>([]);\n  const [showModal, setShowModal] = useState<Boolean>(false);\n\n  useEffect(() => {\n    api.get(`repos/${params.repository}`).then((response) => {\n      setRepository(response.data);\n      console.log('--------------------------------');\n      console.log('HORA (ms): ', new Date().getMilliseconds());\n      console.log('COMANDO: SETAR REPOSITORIO');\n      console.log('--------------------------------');\n    });\n    api\n      .get(`repos/${params.repository}/pulls?per_page=100`)\n      .then((response) => {\n        setPullRequests(response.data);\n        console.log('--------------------------------');\n        console.log('HORA (ms): ', new Date().getMilliseconds());\n        console.log('COMANDO: SETAR PULL REQUESTS');\n        console.log('--------------------------------');\n      });\n  }, [params.repository]);\n\n  useEffect(() => {\n    if (repository) {\n      console.log('--------------------------------');\n      console.log('HORA (ms): ', new Date().getMilliseconds());\n      console.log('EFEITO: REPOSITORIO SETADO');\n      console.log(repository);\n      console.log('--------------------------------');\n    }\n  }, [repository]);\n  useEffect(() => {\n    if (pullRequests.length > 0) {\n      console.log('--------------------------------');\n      console.log('HORA (ms): ', new Date().getMilliseconds());\n      console.log('EFEITO: PULLREQUESTS SETADO');\n      console.log(pullRequests);\n      console.log('--------------------------------');\n    }\n  }, [pullRequests]);\n  useEffect(() => {\n    if (pullRequestsWithCr.length > 0) {\n      console.log('--------------------------------');\n      console.log('HORA (ms): ', new Date().getMilliseconds());\n      console.log('EFEITO: PULLREQUESTS COM CR SETADO');\n      console.log(pullRequestsWithCr);\n      console.log('--------------------------------');\n      postTheDataDuplas();\n    }\n  }, [pullRequestsWithCr]);\n\n  useEffect(() => {\n    if (pullRequests.length > 0) {\n      console.log('--------------------------------');\n      console.log('HORA (ms): ', new Date().getMilliseconds());\n      console.log('COMANDO: SETAR PULLREQUESTS COM CR');\n      console.log('--------------------------------');\n      let helps = 0;\n      let crs = 0;\n      let prWithCr = [];\n      for (let pull of pullRequests) {\n        pull.helpWanted = false;\n        pull.codeReview = false;\n        pull.jaTemDupla = false;\n        if (pull.labels.length > 0) {\n          for (let i = 0; i < pull.labels.length; i++) {\n            if (pull.labels[i].name === 'help wanted') {\n              helps++;\n              pull.helpWanted = true;\n            }\n            if (pull.labels[i].name === 'code-review') {\n              crs++;\n              pull.codeReview = true;\n              prWithCr.push(pull.user.login);\n            }\n          }\n        }\n      }\n      setPullRequestsWithCr(prWithCr);\n      setDataToShow(pullRequests);\n      setCrNumber(crs);\n      setHelpNumber(helps);\n    }\n  }, [pullRequests]);\n\n  function postTheDataDuplas() {\n    console.log('----------------------------------');\n    console.log('STARTED POST', 'AT: ', new Date().getMilliseconds());\n    my_api.post(`/${repository?.id}`, pullRequestsWithCr);\n    console.log(\n      'POST FINISHED',\n      'AT: ',\n      new Date().getMilliseconds(),\n      pullRequestsWithCr,\n    );\n    console.log('----------------------------------');\n    setTimeout(() => {\n      if (repository) {\n        getAndSetDuplasState();\n      }\n    }, 1000);\n  }\n\n  function getAndSetDuplasState() {\n    console.log('----------------------------------');\n    console.log('STARTED GET', 'AT: ', new Date().getMilliseconds());\n    my_api.get(`/${repository?.id}`).then((response) => {\n      setDuplas(response.data);\n      console.log(\n        'GET FINISHED',\n        'AT: ',\n        new Date().getMilliseconds(),\n        response.data,\n      );\n\n      console.log('----------------------------------');\n    });\n  }\n\n  useEffect(() => {\n    if (duplas.length > 0) {\n      console.log('----------------------------------');\n      console.log('DUPLAS UPDATED', 'AT: ', new Date().getMilliseconds());\n      console.log(duplas);\n      console.log('----------------------------------');\n    }\n  }, [duplas]);\n\n  function handleDuplasButton() {\n    handleOpenModal();\n  }\n\n  const handleOpenModal = () => setShowModal(true);\n  const handleCloseModal = () => setShowModal(false);\n\n  function handleHelpButton() {\n    const newPullRequests = pullRequests.filter((pull) => pull.helpWanted);\n    setDataToShow(newPullRequests);\n  }\n  function handleCRButton() {\n    const newPullRequests = pullRequests.filter((pull) => pull.codeReview);\n    setDataToShow(newPullRequests);\n  }\n  function handlePRButton() {\n    setDataToShow(pullRequests);\n  }\n\n  return (\n    <>\n      <Header>\n        <img src={logoImg} width={150} alt=\"Trybe - Projects Explorer\" />\n        <Link to=\"/trybe-projects\">\n          <FiChevronLeft size={16} />\n          Voltar\n        </Link>\n      </Header>\n\n      {repository && (\n        <RepositoryInfo>\n          <header>\n            <img\n              src={repository.owner.avatar_url}\n              alt={repository.owner.login}\n            />\n            <div>\n              <strong>{repository.name}</strong>\n            </div>\n            <button onClick={handleDuplasButton}>\n              <FiUsers size={24} />\n              Ver duplas de CR\n            </button>\n          </header>\n          <ul>\n            <li>\n              <Link to=\"#\" onClick={handleHelpButton}>\n                <strong>{helpNumber}</strong>\n                <span>Pedido(s) de ajuda</span>\n              </Link>\n            </li>\n            <li>\n              <Link to=\"#\" onClick={handleCRButton}>\n                <strong>{crNumber}</strong>\n                <span>Pedido(s) de Code Review</span>\n              </Link>\n            </li>\n            <li>\n              <Link to=\"#\" onClick={handlePRButton}>\n                <strong>{repository.open_issues_count}</strong>\n                <span>Pull Requests</span>\n              </Link>\n            </li>\n          </ul>\n        </RepositoryInfo>\n      )}\n\n      <Modal show={showModal} onHide={handleCloseModal} size={'lg'}>\n        <Modal.Body>\n          <TableContainer>\n            <h1>Duplas de Code Review</h1>\n            {duplas.length > 0 ? (\n              duplas.map((dupla, index) => (\n                <section key={dupla.dupla1}>\n                  <p>{dupla.dupla1}</p>\n                  <FiArrowRight size={20} />\n                  <p>{dupla.dupla2}</p>\n                </section>\n              ))\n            ) : (\n              <article>\n                <div>\n                  <ReactLoading\n                    type={'spin'}\n                    color={'#0fa36b'}\n                    height={'50%'}\n                    width={'50%'}\n                  />\n                  <h2>Carregando</h2>\n                </div>\n              </article>\n            )}\n          </TableContainer>\n        </Modal.Body>\n      </Modal>\n\n      <Issues>\n        {dataToShow\n          .filter((pull) => {\n            return pull.user.login !== 'tryber';\n          })\n          .sort((a, b): number => {\n            if (a.codeReview && !b.codeReview) {\n              return -1;\n            }\n            if (a.helpWanted && !b.helpWanted) {\n              return -1;\n            }\n            return 1;\n          })\n          .map((pull) => (\n            <a key={pull.id} href={pull.html_url}>\n              <img src={pull.user.avatar_url} alt={pull.user.login} />\n              <div>\n                <strong>{pull.user.login}</strong>\n                <p>{pull.title}</p>\n              </div>\n              {pull.helpWanted && <span className=\"red\">Ajuda</span>}\n              {pull.codeReview && <span className=\"green\">Code Review</span>}\n              <FiChevronRight size={20} />\n            </a>\n          ))}\n      </Issues>\n    </>\n  );\n};\n\nexport default Repository;\n"]},"metadata":{},"sourceType":"module"}